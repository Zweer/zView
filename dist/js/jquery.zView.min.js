/**
 * -----------------------------------------------------
 * zView v0.0.0 by @dotzweer
 * -----------------------------------------------------
 * Copyright 2013 Niccol√≤ Olivieri <flicofloc@gmail.com>
 */

if("undefined"==typeof jQuery)throw new Error("zView requires jQuery");!function(a){"use strict";var b=a(window),c=function(b,c){this.$element=a(b),this.options=c,this._initElement(),this._initEvents()};c.prototype._initElement=function(){this.$element.css({position:"static"!==this.$element.css("position")?this.$element.css("position"):"relative"}).addClass(this.options.name).addClass(this.options.theme+"-theme").addClass("zView"),this.$element.children().each(a.proxy(this._initChild,this)),this.$contents=this.$element.children().css({position:"absolute",zIndex:this.options.zIndex}).addClass("zView-item").fadeOut(0),this._initElements(),this.show(this.options.startSlide,this.options.play)},c.prototype._initChild=function(b,c){var d=a(c);switch(d.prop("tagName").toLowerCase()){case"div":return;case"img":d.wrap(a("<div></div>").css({backgroundImage:'url("'+d.attr("src")+'")',backgroundSize:"cover"})).remove();break;default:d.wrap(a("<div></div>"))}},c.prototype._initElements=function(){this._initNavigator(),this._initPlayPause()},c.prototype._initNavigator=function(){this.$navigator=a("<ul></ul>").appendTo(this.$element).addClass("zView-navigator").css({zIndex:this.options.zIndex+20}),this.$navigatorPrevious=a("<a></a>").html(this.options.buttons.htmls.previous).attr("title",this.options.buttons.labels.previous).attr("href","#").click(a.proxy(this.prev,this)).appendTo(a("<li></li>").addClass("zView-navigator-prev").appendTo(this.$navigator)),this.$contents.each(a.proxy(function(b){a("<a></a>").html(this.options.buttons.htmls.element).attr("title","Content "+b).attr("href","#").click(a.proxy(this.show,this,b)).appendTo(a("<li></li>").appendTo(this.$navigator))},this)),this.$navigatorNext=a("<a></a>").html(this.options.buttons.htmls.next).attr("title",this.options.buttons.labels.next).attr("href","#").click(a.proxy(this.next,this)).appendTo(a("<li></li>").addClass("zView-navigator-next").appendTo(this.$navigator)),this.$navigator.css({marginLeft:this.$navigator.width()/-2})},c.prototype._initPlayPause=function(){this.$playPause=a("<a></a>").appendTo(this.$element).addClass("zView-playpause").attr("href","#").css({zIndex:this.options.zIndex+20}).click(a.proxy(this.toggle,this))},c.prototype._refreshPlayPause=function(){this.play?this.$playPause.removeClass("zView-playpause-play").addClass("zView-playpause-pause").html(this.options.buttons.htmls.pause).attr("title",this.options.buttons.labels.pause):this.$playPause.removeClass("zView-playpause-pause").addClass("zView-playpause-play").html(this.options.buttons.htmls.play).attr("title",this.options.buttons.labels.play)},c.prototype._initEvents=function(){b.resize(a.proxy(this._onResize,this)).resize()},c.prototype._onResize=function(){this.$contents.css({width:this.$element.width(),height:this.$element.height()})},c.prototype._show=function(){var b=a(this.$contents[this.current]);return b.css({zIndex:this.options.zIndex+10}).fadeIn(this.options.transition,a.proxy(this._showComplete,this)),this},c.prototype._showComplete=function(){var b=a(this.$contents[this.current]);this.$contents.not(b).fadeOut(0),b.css("zIndex",this.options.zIndex)},c.prototype.show=function(b,c){return"string"==typeof b?isNaN(parseInt(b,10))?"+="===b.substr(0,2)?this.current+=parseInt(b.substr(2),10):"-="===b.substr(0,2)?this.current-=parseInt(b.substr(2),10):"next"===b?this.current++:"prev"===b||"previous"===b?this.current--:"first"===b?this.current=0:"last"===b&&(this.current=this.$contents.length-1):this.current=parseInt(b,10):"number"==typeof b&&(this.current=b),this.current%=this.$contents.length,this.stop(),c||this.options.playAfterMove?(this.play=!0,this.timeout=setTimeout(a.proxy(this.next,this,!0),this.options.delay)):this.play=!1,this._refreshPlayPause(),this._show()},c.prototype.next=function(a){return this.show("next",a)},c.prototype.prev=function(a){return this.show("prev",a)},c.prototype.first=function(a){return this.show("first",a)},c.prototype.last=function(a){return this.show("last",a)},c.prototype.stop=function(){return clearTimeout(this.timeout),this},c.prototype.pause=function(){return this},c.prototype.play=function(){return this.next(!0)},c.prototype.toggle=function(){return this.play?this.stop():this.play()},c.DEFAULT={name:"zView",theme:"default",zIndex:1,startSlide:0,transition:400,play:!0,delay:5e3,playAfterMove:!1,buttons:{htmls:{previous:"&laquo;",next:"&raquo;",element:"&middot;",play:"&#x25BA;",pause:"&#x2590; &#x2590;"},labels:{previous:"Previous",next:"Next",play:"Play",pause:"Pause"}}},a.zView=function(b,d){return new c(b,a.extend(!0,{},c.DEFAULT,d))},a.fn.zView=function(b){return this.each(function(){var c=a(this),d=c.data("zview"),e=a.extend({},c.data(),"object"==typeof b&&b);d||c.data("zview",d=a.zView(c,e)),"string"==typeof b?"+="!==b.substr(0,2)&&"-="!==b.substr(0,2)&&isNaN(parseInt(b,10))?d[b]():d.show(b):"number"==typeof b&&d.show()})}}(jQuery);